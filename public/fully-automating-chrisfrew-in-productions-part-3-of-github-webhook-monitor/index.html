<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#4078c0;text-decoration:none;}a:hover,a:active{text-decoration:underline;}</style><meta data-react-helmet="true" name="description" content="Background and Overview of this Technologically Amazing Accomplishment After a bit of thinking about my automation project, I settled on a single subdomain (atâ€¦"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#000000"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><title data-react-helmet="true">Fully Automating Chrisfrew.in Productions - Part 3 of ??? - Building a GitHub Webhook Monitor | Chris&#x27; Full Stack Blog</title><meta name="generator" content="Gatsby 2.18.12"/><meta data-react-helmet="true" property="og:title" content="Fully Automating Chrisfrew.in Productions - Part 3 of ??? - Building a GitHub Webhook Monitor"/><meta data-react-helmet="true" property="og:description" content="Background and Overview of this Technologically Amazing Accomplishment After a bit of thinking about my automation project, I settled on a single subdomain (atâ€¦"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Chris Frewin"/><meta data-react-helmet="true" name="twitter:title" content="Fully Automating Chrisfrew.in Productions - Part 3 of ??? - Building a GitHub Webhook Monitor"/><meta data-react-helmet="true" name="twitter:description" content="Background and Overview of this Technologically Amazing Accomplishment After a bit of thinking about my automation project, I settled on a single subdomain (atâ€¦"/><style data-href="/styles.053af9e80477c975aa55.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#000;text-shadow:0 1px #fff}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}.token.punctuation{color:#999}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}body,html{background-color:transparent;color:#fff}header,main{pointer-events:none}header{z-index:20;position:relative}footer{margin-top:6rem}footer,main{position:relative;z-index:10}a{color:#f92672;z-index:10;pointer-events:all}canvas{pointer-events:all}.canvas-mask,canvas{height:100vh;top:0;left:0;width:100vw;position:fixed}.canvas-mask{pointer-events:none;background-color:rgba(0,0,0,.5);z-index:1}.background-mask{pointer-events:none;background-color:#000;height:100vh;top:0;left:0;width:100vw;position:fixed}.twentytwenty-fun{display:inline-block;position:relative;font-size:.75rem;font-family:Courier New,Courier,monospace;-webkit-animation:hover 2s ease-in-out infinite alternate;animation:hover 2s ease-in-out infinite alternate;line-height:.75rem;text-align:center}h1{border-bottom:none}@-webkit-keyframes hover{0%{-webkit-transform:translateY(-10%);transform:translateY(-10%);-webkit-transform:translateX(-10%);transform:translateX(-10%);-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:translateY(10%);transform:translateY(10%);-webkit-transform:translateX(10%);transform:translateX(10%);-webkit-transform:rotate(30deg);transform:rotate(30deg)}}@keyframes hover{0%{-webkit-transform:translateY(-10%);transform:translateY(-10%);-webkit-transform:translateX(-10%);transform:translateX(-10%);-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:translateY(10%);transform:translateY(10%);-webkit-transform:translateX(10%);transform:translateX(10%);-webkit-transform:rotate(30deg);transform:rotate(30deg)}}</style><link as="script" rel="preload" href="/component---src-templates-blog-post-js-2642abeb110b544c12ef.js"/><link as="script" rel="preload" href="/commons-6d579bbbe3f0f0f9e163.js"/><link as="script" rel="preload" href="/app-4c82f1120542748bc39c.js"/><link as="script" rel="preload" href="/styles-5d031bf83756cf4dd9d4.js"/><link as="script" rel="preload" href="/webpack-runtime-4cd14b33a27ff34dca30.js"/><link as="fetch" rel="preload" href="/page-data/fully-automating-chrisfrew-in-productions-part-3-of-github-webhook-monitor/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:39rem;padding:2.4375rem 1.21875rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Chris&#x27; Full Stack Blog</a></h3></header><main><article><header><h1 style="margin-top:1.625rem;margin-bottom:0">Fully Automating Chrisfrew.in Productions - Part 3 of ??? - Building a GitHub Webhook Monitor</h1><p style="font-size:0.87055rem;line-height:1.625rem;display:block;margin-bottom:1.625rem">July 20, 2018</p></header><section><h2>Background and Overview of this Technologically Amazing Accomplishment</h2>
<p>After a bit of thinking about my automation project, I settled on a single subdomain (at least for now), fittedly named <a href="https://webhooks.chrisfrew.in">https://webhooks.chrisfrew.in</a>. (Go on, you can try clicking on it). However, if youâ€™re not an authorized party (which I check via a <em>secret key</em>) youâ€™ll just be redirected to the plain olâ€™ <a href="https://chrisfrew.in">https://chrisfrew.in</a> - yeah I know, what a crappy blog.</p>
<p>If any of this stuff sounds cool, or perhaps more importantly, sounds like a foreign language, then câ€™mon in and dive in - weâ€™ll get into the technical details and all steps of how all of this can be set up.</p>
<p>Remember, all this stuff is open source too. The repository for the monitor is here: <a href="https://github.com/frewinchristopher/chrisfrew.in-productions-github-bitbucket-monitor">https://github.com/frewinchristopher/chrisfrew.in-productions-github-bitbucket-monitor</a></p>
<p>(The full code is also posted at the bottom of this post.)</p>
<h2>Setting Up a Catch-All webhooks subdomain</h2>
<p>So <a href="chrisfrew.in">chrisfrew.in</a> is registered on Namecheap. We have to just setup two A Records, both for webhooks www.webhooks. It looks like this:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/31f8d6e653672fd7d4238a57a2f72a1b/5aa1a/namecheap_config.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 21.066907775768534%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVQY03WPTQrEIAyF3XiMgmdw0WMWl1M8Y+mi/qO+MY4tDsMEQl6S50dkuRSEGGG9h2+11oqUEihe+w7GGKSUOM+zz0rzk+fWPoTeUxpjwHLOiANA0RfWdq2U6kAhBI7j+AJSkqa3ZfTO+Q/QTxeSyTVNsW1bBy7L8hdI3nv2XOja2VRpUaYLtdbgnGNd198vD6CdgNd14Q3/UyCOC/OIXwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Namecheap configuration"
        title="Namecheap configuration"
        src="/static/31f8d6e653672fd7d4238a57a2f72a1b/799d3/namecheap_config.png"
        srcset="/static/31f8d6e653672fd7d4238a57a2f72a1b/00d96/namecheap_config.png 148w,
/static/31f8d6e653672fd7d4238a57a2f72a1b/0b23c/namecheap_config.png 295w,
/static/31f8d6e653672fd7d4238a57a2f72a1b/799d3/namecheap_config.png 590w,
/static/31f8d6e653672fd7d4238a57a2f72a1b/2a3d6/namecheap_config.png 885w,
/static/31f8d6e653672fd7d4238a57a2f72a1b/5aa1a/namecheap_config.png 1106w"
        sizes="(max-width: 590px) 100vw, 590px"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>Listing on Webhooks subdomain - POST and â€˜allâ€™</h2>
<p>So first off, we want our express app to only do special things on a post to the root (in this case, because I run NGINX, we are already in the webhooks.chrisfrew.in namespace here) - otherwise we redirect to <a href="https://chrisfrew.in">https://chrisfrew.in</a></p>
<p>Notice that even when ARE POSTed to, we still verify the signature of the request, otherwise just like the <code class="language-text">all(&#39;*&#39;)</code>, we redirect (301) the traffic to chrisfrew.in.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">verifySignature</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">determineWebhook</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// authentic source</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Authentication successful; processing data:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Someone else calling</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Authentication failed; redirecting them to https://chrisfrew.in'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token number">301</span><span class="token punctuation">,</span> <span class="token string">'https://chrisfrew.in/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Redirect to domain root</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Someone else calling</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Authentication failed; redirecting them to https://chrisfrew.in'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token number">301</span><span class="token punctuation">,</span> <span class="token string">'https://chrisfrew.in/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Redirect to domain root</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Only webhook requests allowed at this address</span></code></pre></div>
<h2>Determine What type of Webhook</h2>
<p>Right now I only process GitHub and Bitbucket Webhooks. Itâ€™s rudimentary, and itâ€™s not even finished, but it works for GitHub:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">determineWebhook</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">oData</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> sStatus<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>sender<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// GitHub</span>
    sStatus <span class="token operator">=</span> <span class="token string">"New head commit in "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">"): "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>committer<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>added<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
      sStatus <span class="token operator">=</span> sStatus <span class="token operator">+</span> <span class="token string">" added "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>added<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" files, "</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>modified<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
      sStatus <span class="token operator">=</span> sStatus <span class="token operator">+</span>  <span class="token string">" modified "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>modified<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" files, and"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>removed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sStatus <span class="token operator">=</span> sStatus <span class="token operator">+</span>  <span class="token string">" removed "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>removed<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" files."</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Attempting to pull from this repository..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">pull</span><span class="token punctuation">(</span>oRepositoryPathValuePairs<span class="token punctuation">[</span>oData<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//twitterBotUtils.postStatus(sStatus);</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>actor<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Bitbucket</span>
    
    <span class="token comment">//twitterBotUtils.postStatus(sStatus);</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// some other webhook (there are no others yet)</span>
    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h2>GitHub Integration</h2>
<p>With our subdomain set up and our express server serving there, we can start processing requests for <code class="language-text">webhooks.chrisfrew.in</code>. The important thing here is to validate requests. Imagine what could happen without validation, (if I eventualy do hook this up to my twitter bot to post every time a repository is updated) just anyone could send random github-ish looking json data to <code class="language-text">webhooks.chrisfrew.in</code>, and my server would take action, even when its not coming from a validate That would be really annoying, and plus, it would make me seem <em>way</em> more productive than I am with my repositories. ðŸ˜‚ðŸ˜‚ðŸ˜‚ So yeah, validation is an important step. </p>
<p>GitHubâ€™s way of doing authentication for webhooks is to take the content of the payload, concatenate that with the secret key, and then hash it. You then do the same on your server, since you yourself also know the secret key, and if the hashes match, violÃ¡! You know itâ€™s coming from GitHub. We accomplish this in Nodejs in a function called <code class="language-text">verifySignature</code> like so:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Verification function to check if it is actually GitHub who is POSTing here</span>
<span class="token keyword">const</span> <span class="token function-variable function">verifySignature</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'user-agent'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'GitHub-Hookshot'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Compare their hmac signature to our hmac signature</span>
  <span class="token comment">// (hmac = hash-based message authentication code)</span>
  <span class="token keyword">const</span> sExternalSignature <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'x-hub-signature'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> oData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> sSecret <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">WEBHOOK_SECRET</span><span class="token punctuation">;</span> 
  <span class="token keyword">const</span> sInternalSignature <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">sha1=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crypto<span class="token punctuation">.</span><span class="token function">createHmac</span><span class="token punctuation">(</span><span class="token string">'sha1'</span><span class="token punctuation">,</span> sSecret<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>oData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">timingSafeEqual</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>sExternalSignature<span class="token punctuation">)</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>sInternalSignature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h2>GitHub Integration</h2>
<p>So, we know - then on the production server we want to naturally pull this newest code from the remote? For that, there is the NPM package <code class="language-text">simple-git</code> <a href="https://github.com/steveukx/git-js#readme">https://github.com/steveukx/git-js#readme</a>.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">pull</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sRootRepositoryDirectory</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  git<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pull</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> update</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>update <span class="token operator">&amp;&amp;</span> update<span class="token punctuation">.</span>summary<span class="token punctuation">.</span>changes<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// there is indeed an update found on the remote</span>
        <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"This is an app templated by create-react-app; We need to issue 'npm run build' to build new source..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"commit your changes or stash them"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Changes need to be stashed; stashing automatically..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">stashAndPull</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token comment">// TODO: more error cases? ...</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">stashAndPull</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sRootRepositoryDirectory</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  git<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Stash succesfull, attempting to pull again..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">pull</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h2>Build Integration</h2>
<p>So, I thought it was nice that we could detect pushes to the repository and then . But, with my create-react-apps, could I also build the source. If you were eagle-eyed, you may have seen that sneaky <code class="language-text">build()</code> function. That function looks like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">build</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'npm run build'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cwd<span class="token punctuation">:</span> <span class="token string">'../charge-keyboard.com'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">messageHub</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>stderr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">messageHub</span><span class="token punctuation">(</span>stderr<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Build command successfully sent. The site should be live with the newly commited changes incorporated."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The <em>very</em> cool thing here, at least I think, is that since I run my <code class="language-text">index.js</code> servers with <code class="language-text">forever</code>, when the source is built, whatever <code class="language-text">index.js</code> is serving is updated, without affecting the runtime of <code class="language-text">index.js</code> itself! So, I am nearly approaching a fully integrated build system that was all custom built. ðŸ˜„</p>
<h2>Other Fun stuff</h2>
<p>You know how when your <code class="language-text">npm start</code> wont work, only because of a missing module? Iâ€™ve always been like, well, the <em>single</em> solution here <em>is to just install the friggen module</em> Well, thanks to stdout, we can try to read those missing modules, install it, and try <code class="language-text">npm start</code> again. This is something I am working on.</p>
<p>Youâ€™ll notice a lot of the code is parsing <code class="language-text">stdout</code> as strings - I realize out to an infinite time scale, this isnâ€™t a most robust way of checking error messages, so Iâ€™m working towards parsing the actual errors codes from Nodejs and reacting from those, instead of the error text itself.</p>
<p>You may have also noticed the function messageHub for nearly every logging type message. Indeed, we do log to the console, but I built this hub-type function so we could add more ways of messaging, one of them is through a Slack bot, which I show how to do in <a href="https://chrisfrew.in/fully-automating-chrisfrew-in-productions-part-4-of-building-a-slack-bot/">Part 4</a></p>
<p>Youâ€™ll see I have logging util and twitter util functions commented out - they are coming - all with good time!</p>
<h2>To Do List</h2>
<p>Iâ€™ve still got to add all my other sites to the monitor - this is just a matter adding to that key:value that the server monitors - see <code class="language-text">oRepositoryPathValuePairs</code> in the code below for what I am talking about.</p>
<p>What will be really cool is for the GitHub monitor to update itself when it sees that itâ€™s remote - yes, this is like some Terminator-level crap. This will be a special case, because in order for a flawless execution of the monitor server itself, it would have to spawn a child process of itself, then update its code, then start itself, finally killing the child process of its older version.</p>
<h2>Full code</h2>
<p><code class="language-text">index.js</code></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span> <span class="token comment">// strict</span>

<span class="token comment">// external library requires</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> twitterBotUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../chrisfrew.in-productions-shared-functions/utils/twitterBotUtils.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> simpleGit <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'simple-git'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> git <span class="token operator">=</span> <span class="token function">simpleGit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> exec <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exec<span class="token punctuation">;</span>

<span class="token comment">// fixed port on dell</span>
<span class="token keyword">const</span> iPort <span class="token operator">=</span> <span class="token number">8087</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> oRepositoryPathValuePairs <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"charge-keyboard-splash-page"</span><span class="token punctuation">:</span> <span class="token string">"../charge-keyboard.com"</span><span class="token punctuation">,</span>
  <span class="token string">"chrisfrew.in-productions-github-bitbucket-monitor"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment">// super meta - will restart itself</span>
<span class="token punctuation">}</span>

<span class="token comment">// The GitHub webhook MUST be configured to be sent as "application/json"</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Verification function to check if it is actually GitHub who is POSTing here</span>
<span class="token keyword">const</span> <span class="token function-variable function">verifySignature</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'user-agent'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'GitHub-Hookshot'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Compare their hmac signature to our hmac signature</span>
  <span class="token comment">// (hmac = hash-based message authentication code)</span>
  <span class="token keyword">const</span> sExternalSignature <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'x-hub-signature'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> oData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> sSecret <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">WEBHOOK_SECRET</span><span class="token punctuation">;</span> 
  <span class="token keyword">const</span> sInternalSignature <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">sha1=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crypto<span class="token punctuation">.</span><span class="token function">createHmac</span><span class="token punctuation">(</span><span class="token string">'sha1'</span><span class="token punctuation">,</span> sSecret<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>oData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">timingSafeEqual</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>sExternalSignature<span class="token punctuation">)</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>sInternalSignature<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">determineWebhook</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">oData</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> sStatus<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>sender<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// GitHub</span>
    sStatus <span class="token operator">=</span> <span class="token string">"New head commit in "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">"): "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>committer<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>added<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
      sStatus <span class="token operator">=</span> sStatus <span class="token operator">+</span> <span class="token string">" added "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>added<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" files, "</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>modified<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
      sStatus <span class="token operator">=</span> sStatus <span class="token operator">+</span>  <span class="token string">" modified "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>modified<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" files, and"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>removed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sStatus <span class="token operator">=</span> sStatus <span class="token operator">+</span>  <span class="token string">" removed "</span> <span class="token operator">+</span> oData<span class="token punctuation">.</span>head_commit<span class="token punctuation">.</span>removed<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" files."</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Attempting to pull from this repository..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">pull</span><span class="token punctuation">(</span>oRepositoryPathValuePairs<span class="token punctuation">[</span>oData<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//twitterBotUtils.postStatus(sStatus);</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oData<span class="token punctuation">.</span>actor<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Bitbucket</span>
    
    <span class="token comment">//twitterBotUtils.postStatus(sStatus);</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// some other webhook (there are no others yet)</span>
    
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pull</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sRootRepositoryDirectory</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  git<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pull</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> update</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>update <span class="token operator">&amp;&amp;</span> update<span class="token punctuation">.</span>summary<span class="token punctuation">.</span>changes<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// there is indeed an update found on the remote</span>
        <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"This is an app templated by create-react-app; We need to issue 'npm run build' to build new source..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"commit your changes or stash them"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Changes need to be stashed; stashing automatically..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">stashAndPull</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token comment">// TODO: more error cases? ...</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">stashAndPull</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sRootRepositoryDirectory</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  git<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Stash succesfull, attempting to pull again..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">pull</span><span class="token punctuation">(</span>sRootRepositoryDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">build</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'npm run build'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cwd<span class="token punctuation">:</span> <span class="token string">'../charge-keyboard.com'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">messageHub</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>stderr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">messageHub</span><span class="token punctuation">(</span>stderr<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       <span class="token function">messageHub</span><span class="token punctuation">(</span><span class="token string">"Build command successfully sent. The site should be live with the newly commited changes incorporated."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">messageHub</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sMessage</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// all the ways of messaging combined into one messaging "hub"</span>
  <span class="token comment">//twitterBotUtils.postStatus(sMessage); // // TODO: : make live!!!</span>
  <span class="token comment">//loggingUtils.logMessage(sMessage): // TODO: also make live!!!</span>
  <span class="token function">slackBotWebHook</span><span class="token punctuation">(</span>sMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">slackBotWebHook</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sMessage</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CHRISFREW_IN_SLACK_BOT_WEBHOOK_URL</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    text<span class="token punctuation">:</span> sMessage
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">verifySignature</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">determineWebhook</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// authentic source</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Authentication successful; processing data:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Someone else calling</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Authentication failed; redirecting them to https://chrisfrew.in'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token number">301</span><span class="token punctuation">,</span> <span class="token string">'https://chrisfrew.in/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Redirect to domain root</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Someone else calling</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Authentication failed; redirecting them to https://chrisfrew.in'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token number">301</span><span class="token punctuation">,</span> <span class="token string">'https://chrisfrew.in/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Redirect to domain root</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Only webhook requests allowed at this address</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>iPort<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Webhook service running at http://localhost:'</span> <span class="token operator">+</span> iPort<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>And again, donâ€™t forget the updated code is all available on GitHub: <a href="https://github.com/frewinchristopher/chrisfrew.in-productions-github-bitbucket-monitor">https://github.com/frewinchristopher/chrisfrew.in-productions-github-bitbucket-monitor</a></p>
<p>Cheers! ðŸº</p></section><hr style="margin-bottom:1.625rem"/><footer><div style="display:flex;margin-bottom:4.0625rem;position:relative;z-index:10"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.8125rem;margin-bottom:0;min-width:50px;border-radius:100%"><img src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAMEAQIF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQIA/9oADAMBAAIQAxAAAAG3DY5430BJ8E1uDf/EABwQAQABBQEBAAAAAAAAAAAAAAECAAMSEyIQIf/aAAgBAQABBQLZ8t3c5dVN5trB30hIwHz/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREQ/9oACAEDAQE/AYiLf//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8BpXv/xAAdEAACAgEFAAAAAAAAAAAAAAAAARAREiExMmGR/9oACAEBAAY/AuQ1bh0N4+M2NRdR/8QAGhABAQEAAwEAAAAAAAAAAAAAAREAMUFh8f/aAAgBAQABPyETXTzKAhyKaLtMhYD1dCnnimD96INM1E8ab//aAAwDAQACAAMAAAAQf99D/8QAFxEAAwEAAAAAAAAAAAAAAAAAAREgIf/aAAgBAwEBPxAK2D//xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAgEBPxBw/wD/xAAfEAEAAgIBBQEAAAAAAAAAAAABABEhMVFBYXGBkfD/2gAIAQEAAT8QfEUFctRs8MRA48wBb2jUtiJS0uJty9aSsq/txBdyKjahpjdlmDp8lOA9T//Z" alt="Chris Frewin" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/184fa5bf6a2882dd8fff63606854db72/30d3a/defaultprofilepicture.jpg 1x,
/static/184fa5bf6a2882dd8fff63606854db72/66c95/defaultprofilepicture.jpg 1.5x,
/static/184fa5bf6a2882dd8fff63606854db72/aacbd/defaultprofilepicture.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/184fa5bf6a2882dd8fff63606854db72/30d3a/defaultprofilepicture.jpg 1x,
/static/184fa5bf6a2882dd8fff63606854db72/66c95/defaultprofilepicture.jpg 1.5x,
/static/184fa5bf6a2882dd8fff63606854db72/aacbd/defaultprofilepicture.jpg 2x" src="/static/184fa5bf6a2882dd8fff63606854db72/30d3a/defaultprofilepicture.jpg" alt="Chris Frewin" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Hi, I&#x27;m <strong>Chris Frewin</strong>, I&#x27;m going to be COURSE MASTER for 2020 (I hope)!<sup><sup><sup>please help me</sup></sup></sup><br/><br/>I&#x27;m an ex-mechanical engineer gone full-remote, full-stack application software engineer, and a hobbyist machine learning/natural language processing developer.<!-- --> <br/><br/>If I&#x27;m not building software, I&#x27;ll be found hiking, skiing, taking pictures, spoiling homebrew, or creating music and art. I (mostly) live in Austria.<br/><br/><a href="https://instagram.com/_chrisfrewin_">You can follow me on Instagram.</a><br/><br/>or,<br/><br/><a href="mailto:frewin.christopher@gmail.com">Send me an email.</a><br/><br/><br/>I&#x27;m a proud member of the <a target="_blank" rel="noopener noreferrer" href="https://dev.to/frewinchristopher">DEV Community</a>, and <a target="_blank" rel="noopener noreferrer" href="https://producthunt.com/@galt_">Product Hunt&#x27;s Makers Community</a>!<br/><br/><span>Sites and products I&#x27;ve built solo or co-developed:</span><br/><br/><a href="https://sirenapparel.us" target="_blank" rel="noopener noreferrer">sirenapparel.us</a> (Solo)<br/><a href="https://chrisfrew.in/nlp-champs" target="_blank" rel="noopener noreferrer">chrisfrew.in/nlp-champs (formerly nlp-champs.com)</a> (Solo)<br/><a href="https://seelengeflÃ¼ster-tirol.com" target="_blank" rel="noopener noreferrer">seelengeflÃ¼ster-tirol.com</a> (Solo)<br/><a href="https://wallstreetbetswally.github.io" target="_blank" rel="noopener noreferrer">wallstreetbetswally.github.io</a> (Solo)<br/><a href="https://chrisfrew.in/invaders" target="_blank" rel="noopener noreferrer">chrisfrew.in/invaders</a> (Solo)<br/><a href="https://chrisfrew.in/portfolio" target="_blank" rel="noopener noreferrer">chrisfrew.in/portfolio</a> (Solo)<br/><a href="https://risch-shoes.com" target="_blank" rel="noopener noreferrer">risch-shoes.com</a> (Co-Developed)<br/><br/><br/></p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/data-analysis-and-pixel-art-of-towns-and-cities-in-pokemon/">â† <!-- -->Data Analysis and Pixel Art of Towns and Cities in Pokemon</a></li><li><a rel="next" href="/fully-automating-chrisfrew-in-productions-part-4-of-building-a-slack-bot/">Fully Automating Chrisfrew.in Productions - Part 4 of ??? - Building a Slack Bot<!-- --> â†’</a></li></ul></nav></main><footer><h5>Â© <!-- -->2020<!-- --> chrisfrew.in<br/>Really like the blog? You can support it:<br/><br/><style>.bmc-button img{width: 27px !important;margin-bottom: 3px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-block !important;color:#000000 !important;background-color:#FFDD00 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 23px !important;letter-spacing: 0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"/><a class="bmc-button" target="_blank" rel="noopener noreferrer" href="https://www.buymeacoffee.com/chrisfrewin"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a cappucino"/><span style="margin-left:5px">Buy me a cappucino</span></a><br/></h5></footer><div class="background-mask"></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-63301492-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/fully-automating-chrisfrew-in-productions-part-3-of-github-webhook-monitor/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-4c82f1120542748bc39c.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-2642abeb110b544c12ef.js"],"component---src-pages-404-js":["/component---src-pages-404-js-ba8fab707f547b8d2140.js"],"component---src-pages-index-js":["/component---src-pages-index-js-511e09b2f0f1386b8494.js"]};/*]]>*/</script><script src="/webpack-runtime-4cd14b33a27ff34dca30.js" async=""></script><script src="/styles-5d031bf83756cf4dd9d4.js" async=""></script><script src="/app-4c82f1120542748bc39c.js" async=""></script><script src="/commons-6d579bbbe3f0f0f9e163.js" async=""></script><script src="/component---src-templates-blog-post-js-2642abeb110b544c12ef.js" async=""></script></body></html>